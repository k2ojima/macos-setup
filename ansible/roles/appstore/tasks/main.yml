---

- name: Register installed apps list
  command: mas list
  register: installed_list
  check_mode: false

- name: Install App Store applications
  command: mas install "{{ item.id }}"
  when: "installed_list.stdout_lines | select('search', item.id) | list | length == 0"
  with_items: "{{ apps_list }}"
